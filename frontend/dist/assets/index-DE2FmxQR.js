import{r as e,a as t,u as s,N as r,b as a,L as n,O as l,c as o,R as i,B as d,d as c,e as m}from"./vendor-D9bIhbk6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var h={exports:{}},x={},u=e,p=Symbol.for("react.element"),g=Symbol.for("react.fragment"),f=Object.prototype.hasOwnProperty,j=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v={key:!0,ref:!0,__self:!0,__source:!0};function b(e,t,s){var r,a={},n=null,l=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(l=t.ref),t)f.call(t,r)&&!v.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:p,type:e,key:n,ref:l,props:a,_owner:j.current}}x.Fragment=g,x.jsx=b,x.jsxs=b,h.exports=x;var y=h.exports,N={},k=t;N.createRoot=k.createRoot,N.hydrateRoot=k.hydrateRoot;const w=e.createContext(void 0),C=({children:t})=>{const[s,r]=e.useState([]),a=e.useCallback((e,t,s=5e3)=>{const a=Math.random().toString(36).substr(2,9),l={id:a,message:e,type:t,duration:s};r(e=>[...e,l]),s>0&&setTimeout(()=>{n(a)},s)},[]),n=e.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]),l=e.useCallback(()=>{r([])},[]),o={toasts:s,showToast:a,removeToast:n,clearAllToasts:l};return y.jsxs(w.Provider,{value:o,children:[t,y.jsx(L,{})]})},L=()=>{const{toasts:e,removeToast:t}=M();return 0===e.length?null:y.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>y.jsx(S,{toast:e,onRemove:t},e.id))})},S=({toast:e,onRemove:t})=>y.jsxs("div",{className:`\n      flex items-center p-4 rounded-lg border shadow-lg min-w-80 max-w-md\n      animate-slide-in-right transition-all duration-300 ease-in-out\n      ${(e=>{switch(e){case"success":return"bg-green-500 text-white border-green-600";case"error":return"bg-red-500 text-white border-red-600";case"warning":return"bg-yellow-500 text-white border-yellow-600";case"info":return"bg-blue-500 text-white border-blue-600";default:return"bg-gray-500 text-white border-gray-600"}})(e.type)}\n    `,children:[y.jsx("div",{className:"flex-shrink-0 mr-3",children:(e=>{switch(e){case"success":return y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});case"info":return y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})});default:return null}})(e.type)}),y.jsx("div",{className:"flex-1 text-sm font-medium",children:e.message}),y.jsx("button",{onClick:()=>t(e.id),className:"flex-shrink-0 ml-3 text-white hover:text-gray-200 transition-colors",children:y.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),M=()=>{const t=e.useContext(w);if(void 0===t)throw new Error("useToast must be used within a ToastProvider");return t},T=e.createContext(void 0),P="https://certificatebackend-13k8.onrender.com/api",z=({children:t})=>{const[s,r]=e.useState(null),[a,n]=e.useState(localStorage.getItem("token")),[l,o]=e.useState(!0),{showToast:i}=M();e.useEffect(()=>{(async()=>{const e=localStorage.getItem("token");if(e)try{const t=await fetch(`${P}/auth/me`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const s=await t.json();r(s.data.admin),n(e)}else localStorage.removeItem("token"),n(null)}catch(t){console.error("Auth check failed:",t),localStorage.removeItem("token"),n(null)}o(!1)})()},[]);const d=async()=>{try{a&&await fetch(`${P}/auth/logout`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})}catch(e){console.error("Logout error:",e)}finally{r(null),n(null),localStorage.removeItem("token"),i("Logged out successfully","info")}},c={admin:s,token:a,isLoading:l,login:async(e,t)=>{try{o(!0);const s=await fetch(`${P}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();return s.ok?(r(a.data.admin),n(a.data.token),localStorage.setItem("token",a.data.token),i("Login successful!","success"),!0):(i(a.message||"Login failed","error"),!1)}catch(s){return console.error("Login error:",s),i("Network error. Please try again.","error"),!1}finally{o(!1)}},logout:d,refreshToken:async()=>{try{const e=await fetch(`${P}/auth/refresh`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();return n(t.token),localStorage.setItem("token",t.token),!0}return d(),!1}catch(e){return console.error("Token refresh failed:",e),d(),!1}},updateProfile:async e=>{try{const t=await fetch(`${P}/auth/profile`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();return t.ok?(r(s.admin),i("Profile updated successfully!","success"),!0):(i(s.message||"Profile update failed","error"),!1)}catch(t){return console.error("Profile update error:",t),i("Network error. Please try again.","error"),!1}}};return y.jsx(T.Provider,{value:c,children:t})},B=()=>{const t=e.useContext(T);if(void 0===t)throw new Error("useAuth must be used within an AuthProvider");return t},F=e.createContext(void 0),A=({children:t})=>{const[s,r]=e.useState(()=>{const e=localStorage.getItem("theme");return e||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});e.useEffect(()=>{const e=window.document.documentElement;e.classList.remove("light","dark"),e.classList.add(s),localStorage.setItem("theme",s)},[s]),e.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{localStorage.getItem("theme")||r(e.matches?"dark":"light")};return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]);const a={theme:s,toggleTheme:()=>{r(e=>"light"===e?"dark":"light")},setTheme:e=>{r(e)}};return y.jsx(F.Provider,{value:a,children:t})},E=()=>{const t=e.useContext(F);if(void 0===t)throw new Error("useTheme must be used within a ThemeProvider");return t},W=({size:e="md",className:t="",text:s})=>y.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[y.jsx("div",{className:`spinner ${(()=>{switch(e){case"sm":return"w-4 h-4";case"md":default:return"w-6 h-6";case"lg":return"w-8 h-8";case"xl":return"w-12 h-12"}})()}`}),s&&y.jsx("p",{className:`mt-2 text-muted-foreground ${(()=>{switch(e){case"sm":return"text-sm";case"md":default:return"text-base";case"lg":return"text-lg";case"xl":return"text-xl"}})()}`,children:s})]}),$=({children:e})=>{const{admin:t,isLoading:a}=B(),n=s();return a?y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:y.jsx(W,{size:"lg"})}):t?y.jsx(y.Fragment,{children:e}):y.jsx(r,{to:"/login",state:{from:n},replace:!0})},D=()=>{var t,r;const[o,i]=e.useState(!1),{admin:d,logout:c}=B(),{theme:m,toggleTheme:h}=E(),x=s(),u=a(),p=[{name:"Dashboard",href:"/dashboard",icon:y.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{name:"Templates",href:"/templates",icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{name:"Certificates",href:"/certificates",icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})},{name:"Generate",href:"/generate",icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})},{name:"Settings",href:"/settings",icon:y.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}],g=e=>x.pathname===e||x.pathname.startsWith(e+"/");return y.jsxs("div",{className:"flex h-screen bg-background",children:[y.jsxs("div",{className:`\n        fixed inset-y-0 left-0 z-50 w-64 bg-card border-r border-border transform transition-transform duration-300 ease-in-out\n        ${o?"translate-x-0":"-translate-x-full"}\n        lg:translate-x-0 lg:static lg:inset-0\n      `,children:[y.jsx("div",{className:"flex items-center justify-center h-16 px-4 border-b border-border",children:y.jsx("h1",{className:"text-xl font-bold text-primary",children:"CertGen Pro"})}),y.jsx("nav",{className:"mt-8 px-4",children:y.jsx("ul",{className:"space-y-2",children:p.map(e=>y.jsx("li",{children:y.jsxs(n,{to:e.href,className:`\n                    flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors\n                    ${g(e.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"}\n                  `,onClick:()=>i(!1),children:[e.icon,y.jsx("span",{className:"ml-3",children:e.name})]})},e.name))})})]}),o&&y.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden",onClick:()=>i(!1)}),y.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden lg:ml-0",children:[y.jsx("header",{className:"bg-card border-b border-border px-4 py-4",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("button",{onClick:()=>i(!o),className:"p-2 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground lg:hidden",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),y.jsx("div",{className:"ml-4 lg:ml-0",children:y.jsx("h2",{className:"text-lg font-semibold text-foreground",children:(null==(t=p.find(e=>g(e.href)))?void 0:t.name)||"Dashboard"})})]}),y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsx("button",{onClick:h,className:"p-2 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground",title:`Switch to ${"light"===m?"dark":"light"} mode`,children:"light"===m?y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),y.jsxs("div",{className:"relative group",children:[y.jsxs("button",{className:"flex items-center space-x-2 p-2 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground",children:[y.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:y.jsx("span",{className:"text-sm font-medium text-primary-foreground",children:null==(r=null==d?void 0:d.name)?void 0:r.charAt(0).toUpperCase()})}),y.jsx("span",{className:"hidden md:block text-sm font-medium",children:null==d?void 0:d.name}),y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-card border border-border rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:y.jsxs("div",{className:"py-1",children:[y.jsxs("div",{className:"px-4 py-2 text-sm text-muted-foreground border-b border-border",children:[y.jsx("div",{className:"font-medium text-foreground",children:null==d?void 0:d.name}),y.jsx("div",{className:"text-xs",children:null==d?void 0:d.email})]}),y.jsx(n,{to:"/settings",className:"block px-4 py-2 text-sm text-muted-foreground hover:bg-accent hover:text-accent-foreground",children:"Settings"}),y.jsx("button",{onClick:async()=>{await c(),u("/login")},className:"block w-full text-left px-4 py-2 text-sm text-muted-foreground hover:bg-accent hover:text-accent-foreground",children:"Sign out"})]})})]})]})]})}),y.jsx("main",{className:"flex-1 overflow-auto bg-background",children:y.jsx("div",{className:"container mx-auto px-4 py-6",children:y.jsx(l,{})})})]})]})},R=()=>{var t,a;const[n,l]=e.useState(""),[o,i]=e.useState(""),[d,c]=e.useState(!1),[m,h]=e.useState(!1),{admin:x,login:u,isLoading:p}=B(),{theme:g,toggleTheme:f}=E(),j=(null==(a=null==(t=s().state)?void 0:t.from)?void 0:a.pathname)||"/dashboard";if(x&&!p)return y.jsx(r,{to:j,replace:!0});return p?y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:y.jsx(W,{size:"lg",text:"Loading..."})}):y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 via-background to-secondary/10 px-4 sm:px-6 lg:px-8",children:y.jsxs("div",{className:"max-w-md w-full space-y-8",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"flex justify-center mb-6",children:y.jsx("div",{className:"w-16 h-16 bg-primary rounded-full flex items-center justify-center",children:y.jsx("svg",{className:"w-8 h-8 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})})}),y.jsx("h2",{className:"text-3xl font-bold text-foreground",children:"CertGen Pro"}),y.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Sign in to your admin account"})]}),y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("form",{className:"space-y-6",onSubmit:async e=>{e.preventDefault(),n&&o&&(c(!0),await u(n,o),c(!1))},children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-foreground mb-2",children:"Email address"}),y.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input",placeholder:"Enter your email",value:n,onChange:e=>l(e.target.value),disabled:d})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-foreground mb-2",children:"Password"}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{id:"password",name:"password",type:m?"text":"password",autoComplete:"current-password",required:!0,className:"input pr-10",placeholder:"Enter your password",value:o,onChange:e=>i(e.target.value),disabled:d}),y.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-muted-foreground hover:text-foreground",onClick:()=>h(!m),disabled:d,children:m?y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):y.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),y.jsx("div",{children:y.jsx("button",{type:"submit",disabled:d||!n||!o,className:"btn btn-primary btn-md w-full",children:d?y.jsxs("div",{className:"flex items-center justify-center",children:[y.jsx(W,{size:"sm",className:"mr-2"}),"Signing in..."]}):"Sign in"})})]})})}),y.jsx("div",{className:"flex justify-center",children:y.jsx("button",{onClick:f,className:"p-2 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground transition-colors",title:`Switch to ${"light"===g?"dark":"light"} mode`,children:"light"===g?y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})})}),y.jsx("div",{className:"text-center text-xs text-muted-foreground",children:y.jsx("p",{children:"Â© 2024 CertGen Pro. All rights reserved."})})]})})},I=()=>{const[t,s]=e.useState(null),[r,a]=e.useState(!0),{token:l}=B(),{showToast:o}=M();e.useEffect(()=>{i()},[]);const i=async()=>{try{a(!0);const e=await fetch("https://certificatebackend-13k8.onrender.com/api/certificate/stats/dashboard",{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();s(t.data)}else o("Failed to load dashboard statistics","error")}catch(e){console.error("Error fetching dashboard stats:",e),o("Network error while loading dashboard","error")}finally{a(!1)}},d=e=>{switch(e){case"active":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/20";case"archived":default:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-900/20";case"pending":return"text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/20"}};return r?y.jsx("div",{className:"flex items-center justify-center h-64",children:y.jsx(W,{size:"lg",text:"Loading dashboard..."})}):t?y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"",children:[y.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Dashboard"}),y.jsx("p",{className:"text-muted-foreground mt-1",children:"Welcome back! Here's an overview of your certificate management system."})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Certificates"}),y.jsx("p",{className:"text-2xl font-bold text-foreground",children:t.overview.totalCertificates})]}),y.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:y.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})})]})})}),y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Downloads"}),y.jsx("p",{className:"text-2xl font-bold text-foreground",children:t.overview.totalDownloads})]}),y.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center",children:y.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})})}),y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Certificates"}),y.jsx("p",{className:"text-2xl font-bold text-foreground",children:t.statusBreakdown.active||0})]}),y.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-lg flex items-center justify-center",children:y.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})})}),y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Archived"}),y.jsx("p",{className:"text-2xl font-bold text-foreground",children:t.statusBreakdown.archived||0})]}),y.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-900/20 rounded-lg flex items-center justify-center",children:y.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8l4 4 4-4m6 5l-3 3-3-3"})})})]})})})]}),y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Quick Actions"}),y.jsx("p",{className:"card-description",children:"Common tasks to get you started"})]}),y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[y.jsxs(n,{to:"/generate",className:"flex items-center p-4 border border-border rounded-lg hover:bg-accent hover:text-accent-foreground transition-colors",children:[y.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center mr-3",children:y.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-medium",children:"Generate Certificate"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a new certificate"})]})]}),y.jsxs(n,{to:"/templates",className:"flex items-center p-4 border border-border rounded-lg hover:bg-accent hover:text-accent-foreground transition-colors",children:[y.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center mr-3",children:y.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-medium",children:"Manage Templates"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload and edit templates"})]})]}),y.jsxs(n,{to:"/certificates",className:"flex items-center p-4 border border-border rounded-lg hover:bg-accent hover:text-accent-foreground transition-colors",children:[y.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center mr-3",children:y.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-medium",children:"View Certificates"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Browse all certificates"})]})]})]})})]}),y.jsxs("div",{className:"card",children:[y.jsx("div",{className:"card-header",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"card-title",children:"Recent Certificates"}),y.jsx("p",{className:"card-description",children:"Latest certificates generated"})]}),y.jsx(n,{to:"/certificates",className:"btn btn-outline btn-sm",children:"View All"})]})}),y.jsx("div",{className:"card-content",children:t.overview.recentCertificates.length>0?y.jsx("div",{className:"space-y-4",children:t.overview.recentCertificates.map(e=>{return y.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:y.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-medium text-foreground",children:e.participantName}),y.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.certificateId," â€¢ ",e.template.name]})]})]}),y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${d(e.status)}`,children:e.status}),y.jsx("span",{className:"text-sm text-muted-foreground",children:(t=e.createdAt,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})]})]},e._id);var t})}):y.jsxs("div",{className:"text-center py-8",children:[y.jsx("svg",{className:"w-12 h-12 text-muted-foreground mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})}),y.jsx("p",{className:"text-muted-foreground",children:"No certificates generated yet"}),y.jsx(n,{to:"/generate",className:"btn btn-primary btn-sm mt-4",children:"Generate Your First Certificate"})]})})]})]}):y.jsxs("div",{className:"text-center py-12",children:[y.jsx("p",{className:"text-muted-foreground",children:"Failed to load dashboard data"}),y.jsx("button",{onClick:i,className:"btn btn-primary btn-sm mt-4",children:"Retry"})]})};function V(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;if(e&&"object"==typeof e){if("message"in e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch{return"Unknown error object"}}return"Unknown error"}function O(e,t){return`Network error while ${e}: ${V(t)}`}const U=()=>{const[t,s]=e.useState([]),[r,a]=e.useState(!0),[l,o]=e.useState(""),[i,d]=e.useState("all"),[c,m]=e.useState(1),[h,x]=e.useState(1),[u,p]=e.useState(!1),[g,f]=e.useState(""),{token:j}=B(),{showToast:v}=M(),b="https://certificatebackend-13k8.onrender.com/api";e.useEffect(()=>{N()},[c,l,i]);const N=async()=>{try{a(!0);const e=new URLSearchParams({page:c.toString(),limit:10..toString(),search:l,status:"all"===i?"":i}),t=await fetch(`${b}/template?${e}`,{headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();s(e.data.templates),x(e.data.pagination.pages)}else v("Failed to load templates","error")}catch(e){console.error("Error fetching templates:",e);const t=O("loading templates",e);v(t,"error"),s([]),x(0)}finally{a(!1)}},k=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},w=t.filter(e=>{const t=e.name.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase()),s="all"===i||"active"===i&&e.isActive||"inactive"===i&&!e.isActive;return t&&s});return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Templates"}),y.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your certificate templates"})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("input",{type:"text",placeholder:"Enter template name (required)",value:g,onChange:e=>f(e.target.value),className:"input input-bordered w-full max-w-xs "+(""===g.trim()?"border-red-300 focus:border-red-500":""),disabled:u,required:!0}),""===g.trim()&&y.jsx("span",{className:"text-xs text-red-500 mt-1",children:"Template name is required"})]}),y.jsx("input",{type:"file",id:"template-upload",accept:".jpg,.jpeg,.png,.gif,.bmp,.webp,.svg,.tiff,.tif,.pdf",onChange:async e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(!s)return;if(["image/jpeg","image/jpg","image/png","image/gif","image/bmp","image/webp","image/svg+xml","image/tiff","image/tif","application/pdf"].includes(s.type))if(s.size>26214400)v("File size must be less than 25MB","error");else if(g.trim())try{p(!0);const e=new FormData;e.append("template",s),e.append("name",g.trim()),e.append("description",`Template uploaded on ${(new Date).toLocaleDateString()}`);const t=await fetch(`${b}/template/upload`,{method:"POST",headers:{Authorization:`Bearer ${j}`},body:e}),r=await t.json();t.ok?(v("Template uploaded successfully!","success"),N()):v(r.message||"Failed to upload template","error")}catch(r){console.error("Error uploading template:",r);const e=O("uploading template",r);v(e,"error")}finally{p(!1),e.target.value="",f("")}else v("Template name cannot be empty","error");else v("Please upload a supported file format: JPEG, PNG, GIF, BMP, WebP, SVG, TIFF, or PDF","error")},className:"hidden",disabled:u||""===g.trim()}),y.jsx("label",{htmlFor:"template-upload",className:"btn btn-primary btn-md cursor-pointer "+(u||""===g.trim()?"opacity-50 cursor-not-allowed":""),title:""===g.trim()?"Please enter a template name first":"Upload template",children:u?y.jsxs("div",{className:"flex items-center",children:[y.jsx(W,{size:"sm",className:"mr-2"}),"Uploading..."]}):y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Upload Template"]})})]})]}),y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[y.jsx("div",{className:"flex-1",children:y.jsx("input",{type:"text",placeholder:"Search templates...",value:l,onChange:e=>o(e.target.value),className:"input"})}),y.jsx("div",{className:"sm:w-48",children:y.jsxs("select",{value:i,onChange:e=>d(e.target.value),className:"input",children:[y.jsx("option",{value:"all",children:"All Templates"}),y.jsx("option",{value:"active",children:"Active Only"}),y.jsx("option",{value:"inactive",children:"Inactive Only"})]})})]})})}),r?y.jsx("div",{className:"flex items-center justify-center h-64",children:y.jsx(W,{size:"lg",text:"Loading templates..."})}):w.length>0?y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>{return y.jsx("div",{className:"card",children:y.jsxs("div",{className:"card-content",children:[y.jsxs("div",{className:"flex items-start justify-between mb-4",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("h3",{className:"font-semibold text-foreground mb-1",children:e.name}),y.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description})]}),y.jsx("div",{className:"flex items-center space-x-2 ml-4",children:y.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(e.isActive?"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/20":"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-900/20"),children:e.isActive?"Active":"Inactive"})})]}),y.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground mb-4",children:[y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"File:"}),y.jsx("span",{children:e.filename})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"Size:"}),y.jsx("span",{children:k(e.fileSize)})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"Placeholders:"}),y.jsx("span",{children:e.placeholders.length})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"Usage:"}),y.jsxs("span",{children:[e.usageCount," times"]})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"Created:"}),y.jsx("span",{children:(t=e.createdAt,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})]})]}),y.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[y.jsxs("div",{className:"flex space-x-2",children:[y.jsx(n,{to:`/templates/${e._id}/edit`,className:"btn btn-outline btn-sm",children:"Edit"}),y.jsx("button",{onClick:()=>(async(e,t)=>{try{(await fetch(`${b}/template/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"},body:JSON.stringify({isActive:!t})})).ok?(v(`Template ${t?"deactivated":"activated"} successfully`,"success"),N()):v("Failed to update template status","error")}catch(s){console.error("Error updating template:",s);const e=O("updating template",s);v(e,"error")}})(e._id,e.isActive),className:"btn btn-sm "+(e.isActive?"btn-secondary":"btn-primary"),children:e.isActive?"Deactivate":"Activate"})]}),y.jsx("a",{href:`${b}/template/${e._id}/file`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/80 transition-colors",title:"View template file",children:y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]})},e._id);var t})}):y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"text-center py-12",children:[y.jsx("svg",{className:"w-12 h-12 text-muted-foreground mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),y.jsx("p",{className:"text-muted-foreground mb-4",children:l||"all"!==i?"No templates match your search criteria":"No templates uploaded yet"}),!l&&"all"===i&&y.jsxs("label",{htmlFor:"template-upload",className:"btn btn-primary btn-md cursor-pointer",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Upload Your First Template"]})]})})}),h>1&&y.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[y.jsx("button",{onClick:()=>m(e=>Math.max(e-1,1)),disabled:1===c,className:"btn btn-outline btn-sm",children:"Previous"}),y.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",c," of ",h]}),y.jsx("button",{onClick:()=>m(e=>Math.min(e+1,h)),disabled:c===h,className:"btn btn-outline btn-sm",children:"Next"})]})]})},H=({src:t,alt:s,className:r,token:a})=>{const[n,l]=e.useState(null),[o,i]=e.useState(!0),[d,c]=e.useState(!1);return e.useEffect(()=>((async()=>{try{i(!0);const e=await fetch(t,{headers:{Authorization:`Bearer ${a}`}});if(e.ok){const t=await e.blob(),s=URL.createObjectURL(t);l(s)}else c(!0)}catch(e){c(!0)}finally{i(!1)}})(),()=>{n&&URL.revokeObjectURL(n)}),[t,a]),o?y.jsx("div",{className:"flex items-center justify-center h-full",children:y.jsx(W,{size:"sm"})}):d||!n?y.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Failed to load image"}):y.jsx("img",{src:n,alt:s,className:r,draggable:!1})},G=()=>{const{id:t}=o(),s=a(),{token:r}=B(),{showToast:n}=M(),[l,i]=e.useState(null),[d,c]=e.useState(!0),[m,h]=e.useState(!1),[x,u]=e.useState(null),[p,g]=e.useState(!1),[f,j]=e.useState({x:0,y:0}),v="https://certificatebackend-13k8.onrender.com/api";e.useEffect(()=>{t&&b()},[t]);const b=async()=>{try{c(!0);const e=await fetch(`${v}/template/${t}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();i(t.data.template)}else n("Failed to load template","error"),s("/templates")}catch(e){console.error("Error fetching template:",e);const t=O("loading template",e);n(t,"error"),s("/templates")}finally{c(!1)}},N=(e,t)=>{l&&i({...l,placeholders:l.placeholders.map((s,r)=>r===e?{...s,...t}:s)})},k=()=>{g(!1)};if(d)return y.jsx("div",{className:"flex items-center justify-center h-64",children:y.jsx(W,{size:"lg",text:"Loading template editor..."})});if(!l)return y.jsxs("div",{className:"text-center py-12",children:[y.jsx("p",{className:"text-muted-foreground",children:"Template not found"}),y.jsx("button",{onClick:()=>s("/templates"),className:"btn btn-primary btn-sm mt-4",children:"Back to Templates"})]});const w=null!==x?l.placeholders[x]:null;return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Template Editor"}),y.jsxs("p",{className:"text-muted-foreground mt-1",children:["Editing: ",l.name]})]}),y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx("button",{onClick:()=>s("/templates"),className:"btn btn-outline btn-md",children:"Cancel"}),y.jsx("button",{onClick:()=>{console.log("ðŸš€ Save button clicked - event handler triggered"),alert("Save button clicked! Check console for details."),(async()=>{if(console.log("ðŸ”¥ SAVE BUTTON CLICKED! Function called at:",(new Date).toISOString()),!l)return console.error("No template found"),void n("No template loaded","error");if(!t)return console.error("No template ID found"),void n("Template ID missing","error");if(!r)return console.error("No authentication token found"),void n("Please log in again","error");console.log("=== SAVE TEMPLATE DEBUG ==="),console.log("Template ID:",t),console.log("Token exists:",!!r),console.log("Template object:",l),console.log("Current placeholders:",l.placeholders.map(e=>({type:e.type,x:e.x,y:e.y})));const e=l.placeholders.some(e=>"name"===e.type),s=l.placeholders.some(e=>"id"===e.type);if(console.log("Has name placeholder:",e),console.log("Has ID placeholder:",s),!e||!s){const t=[];return e||t.push("Name"),s||t.push("ID"),console.log("Validation failed - missing types:",t),void n(`Template must have at least one Name placeholder and one ID placeholder. Missing: ${t.join(", ")}. Current placeholders: ${l.placeholders.map(e=>e.type).join(", ")||"none"}`,"error")}console.log("Validation passed, proceeding with save..."),console.log("=== END DEBUG ===");try{h(!0);const e={placeholders:l.placeholders,dimensions:l.dimensions};console.log("=== API REQUEST DEBUG ==="),console.log("Saving template with data:",e),console.log("API URL:",`${v}/template/${t}/placeholders`),console.log("Request headers:",{Authorization:`Bearer ${null==r?void 0:r.substring(0,10)}...`,"Content-Type":"application/json"}),console.log("Request body:",JSON.stringify(e,null,2)),console.log("Testing API connectivity...");try{const e=await fetch(`${v}/template/${t}`,{method:"GET",headers:{Authorization:`Bearer ${r}`}});console.log("Test GET request status:",e.status)}catch(a){console.error("Test GET request failed:",a)}console.log("Making actual save request...");const s=await fetch(`${v}/template/${t}/placeholders`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("Response received:",{status:s.status,statusText:s.statusText,ok:s.ok,headers:Object.fromEntries(s.headers.entries())}),s.ok){const e=await s.json();console.log("Success response data:",e),n("Template saved successfully!","success")}else{let e;try{e=await s.json()}catch(o){e=await s.text()}console.error("Save failed - Response:",e),console.error("Save failed - Status:",s.status),console.error("Save failed - Status Text:",s.statusText);let t=(null==e?void 0:e.message)||"Failed to save template";(null==e?void 0:e.errors)&&e.errors.length>0&&(t+=": "+e.errors.map(e=>e.message).join(", ")),n(t,"error")}}catch(i){console.error("Error saving template:",i);const e=O("saving template",i);n(e,"error")}finally{h(!1)}})()},disabled:m,className:"btn btn-primary btn-md",children:m?y.jsxs("div",{className:"flex items-center",children:[y.jsx(W,{size:"sm",className:"mr-2"}),"Saving..."]}):"Save Template"})]}),y.jsxs("div",{className:"mt-4 p-4 bg-yellow-100 border border-yellow-400 rounded",children:[y.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"ðŸ”§ Debug Test Section"}),y.jsx("button",{onClick:async()=>{console.log("ðŸ§ª TEST: Direct API call without validation");try{const e={placeholders:[{type:"name",x:100,y:100,fontSize:16,fontFamily:"Arial",color:"#000000",fontWeight:"normal",fontStyle:"normal",textAlign:"left",rotation:0}],dimensions:{width:800,height:600}},s=await fetch(`${v}/template/${t}/placeholders`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(e)});console.log("ðŸ§ª TEST Response:",s.status,s.statusText);const a=await s.json();console.log("ðŸ§ª TEST Data:",a),alert(`Test API call: ${s.status} - ${s.statusText}`)}catch(e){console.error("ðŸ§ª TEST Error:",e);const t=V(e);alert(`Test API call failed: ${t}`)}},className:"bg-yellow-500 text-white px-4 py-2 rounded mr-2",children:"ðŸ§ª Test Direct API Call"}),y.jsx("button",{onClick:()=>{console.log("ðŸ” Current State:"),console.log("- Template ID:",t),console.log("- Token exists:",!!r),console.log("- Template loaded:",!!l),console.log("- API Base URL:",v),l&&(console.log("- Placeholders count:",l.placeholders.length),console.log("- Placeholders:",l.placeholders))},className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",children:"ðŸ” Log Current State"}),y.jsx("button",{onClick:async()=>{console.log("ðŸŒ Testing network connectivity...");try{const e=await fetch(`${v}/health`);console.log("Health check:",e.status,e.statusText);const t=await fetch(`${v}/auth/profile`,{headers:{Authorization:`Bearer ${r}`}});console.log("Auth check:",t.status,t.statusText),alert(`Health: ${e.status}, Auth: ${t.status}`)}catch(e){console.error("Network test failed:",e);const t=V(e);alert(`Network test failed: ${t}`)}},className:"bg-green-500 text-white px-4 py-2 rounded",children:"ðŸŒ Test Network"})]})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[y.jsx("div",{className:"lg:col-span-3",children:y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Template Preview"}),y.jsx("p",{className:"card-description",children:"Click and drag to position placeholders"})]}),y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"relative border-2 border-dashed border-border rounded-lg overflow-hidden bg-white",style:{width:"100%",maxWidth:"800px",aspectRatio:l.dimensions?`${l.dimensions.width} / ${l.dimensions.height}`:"16 / 9"},onMouseMove:e=>{if(!p||null===x||!l)return;const t=e.currentTarget.getBoundingClientRect(),s=e.clientX-t.left-f.x,r=e.clientY-t.top-f.y;N(x,{x:Math.max(0,s),y:Math.max(0,r)})},onMouseUp:k,onMouseLeave:k,children:[r?y.jsx(H,{src:`${v}/template/${l._id}/file`,alt:l.name,className:"w-full h-full object-contain",token:r}):y.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Please log in to view template"}),l.placeholders.map((e,t)=>y.jsx("div",{className:"absolute cursor-move border-2 px-2 py-1 rounded "+(x===t?"border-primary bg-primary/10":"border-gray-400 bg-gray-100/80"),style:{left:e.x,top:e.y,fontSize:e.fontSize,fontFamily:e.fontFamily,color:e.color,fontWeight:e.fontWeight},onMouseDown:e=>((e,t)=>{if(e.preventDefault(),!(null==l?void 0:l.placeholders[t]))return;u(t),g(!0);const s=e.currentTarget.getBoundingClientRect();j({x:e.clientX-s.left,y:e.clientY-s.top})})(e,t),onClick:()=>u(t),children:"name"===e.type?"Name":"ID"},t))]})})]})}),y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"card",children:[y.jsx("div",{className:"card-header",children:y.jsx("h3",{className:"card-title",children:"Placeholders"})}),y.jsxs("div",{className:"card-content",children:[y.jsxs("button",{onClick:()=>{if(!l)return;const e={type:l.placeholders.some(e=>"id"===e.type)?"name":"id",x:100,y:100,fontSize:24,fontFamily:"Arial",color:"#000000",fontWeight:"normal",fontStyle:"normal",textAlign:"left",rotation:0};i({...l,placeholders:[...l.placeholders,e]})},className:"btn btn-primary btn-sm w-full mb-4",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Placeholder"]}),y.jsx("div",{className:"space-y-2",children:l.placeholders.map((e,t)=>y.jsx("div",{className:"p-2 border rounded cursor-pointer "+(x===t?"border-primary bg-primary/5":"border-border hover:bg-accent"),onClick:()=>u(t),children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"text-sm font-medium",children:"name"===e.type?"Name":"ID"}),y.jsx("button",{onClick:e=>{var s;e.stopPropagation(),s=t,l&&(i({...l,placeholders:l.placeholders.filter((e,t)=>t!==s)}),x===s&&u(null))},className:"text-red-500 hover:text-red-700",children:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},t))})]})]}),w&&y.jsxs("div",{className:"card",children:[y.jsx("div",{className:"card-header",children:y.jsx("h3",{className:"card-title",children:"Properties"})}),y.jsxs("div",{className:"card-content space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),y.jsxs("select",{value:w.type,onChange:e=>N(x,{type:e.target.value}),className:"input",children:[y.jsx("option",{value:"name",children:"Name"}),y.jsx("option",{value:"id",children:"ID"})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),y.jsx("input",{type:"number",value:w.x,onChange:e=>N(x,{x:parseInt(e.target.value)||0}),className:"input"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),y.jsx("input",{type:"number",value:w.y,onChange:e=>N(x,{y:parseInt(e.target.value)||0}),className:"input"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Font Size"}),y.jsx("input",{type:"number",value:w.fontSize,onChange:e=>N(x,{fontSize:parseInt(e.target.value)||12}),className:"input",min:"8",max:"72"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Font Family"}),y.jsxs("select",{value:w.fontFamily,onChange:e=>N(x,{fontFamily:e.target.value}),className:"input",style:{fontFamily:w.fontFamily},children:[y.jsx("option",{value:"Arial",style:{fontFamily:"Arial"},children:"Arial"}),y.jsx("option",{value:"Helvetica",style:{fontFamily:"Helvetica"},children:"Helvetica"}),y.jsx("option",{value:"Verdana",style:{fontFamily:"Verdana"},children:"Verdana"}),y.jsx("option",{value:"Calibri",style:{fontFamily:"Calibri"},children:"Calibri"}),y.jsx("option",{value:"Tahoma",style:{fontFamily:"Tahoma"},children:"Tahoma"}),y.jsx("option",{value:"Geneva",style:{fontFamily:"Geneva"},children:"Geneva"}),y.jsx("option",{value:"Lucida Sans",style:{fontFamily:"Lucida Sans"},children:"Lucida Sans"}),y.jsx("option",{value:"Trebuchet MS",style:{fontFamily:"Trebuchet MS"},children:"Trebuchet MS"}),y.jsx("option",{value:"Century Gothic",style:{fontFamily:"Century Gothic"},children:"Century Gothic"}),y.jsx("option",{value:"Franklin Gothic Medium",style:{fontFamily:"Franklin Gothic Medium"},children:"Franklin Gothic Medium"}),y.jsx("option",{value:"Segoe UI",style:{fontFamily:"Segoe UI"},children:"Segoe UI"}),y.jsx("option",{value:"Open Sans",style:{fontFamily:"Open Sans"},children:"Open Sans"}),y.jsx("option",{value:"Roboto",style:{fontFamily:"Roboto"},children:"Roboto"}),y.jsx("option",{value:"Lato",style:{fontFamily:"Lato"},children:"Lato"}),y.jsx("option",{value:"Montserrat",style:{fontFamily:"Montserrat"},children:"Montserrat"}),y.jsx("option",{value:"Source Sans Pro",style:{fontFamily:"Source Sans Pro"},children:"Source Sans Pro"}),y.jsx("option",{value:"Ubuntu",style:{fontFamily:"Ubuntu"},children:"Ubuntu"}),y.jsx("option",{value:"Nunito",style:{fontFamily:"Nunito"},children:"Nunito"}),y.jsx("option",{value:"Poppins",style:{fontFamily:"Poppins"},children:"Poppins"}),y.jsx("option",{value:"Inter",style:{fontFamily:"Inter"},children:"Inter"}),y.jsx("option",{value:"Times New Roman",style:{fontFamily:"Times New Roman"},children:"Times New Roman"}),y.jsx("option",{value:"Georgia",style:{fontFamily:"Georgia"},children:"Georgia"}),y.jsx("option",{value:"Times",style:{fontFamily:"Times"},children:"Times"}),y.jsx("option",{value:"Book Antiqua",style:{fontFamily:"Book Antiqua"},children:"Book Antiqua"}),y.jsx("option",{value:"Palatino",style:{fontFamily:"Palatino"},children:"Palatino"}),y.jsx("option",{value:"Garamond",style:{fontFamily:"Garamond"},children:"Garamond"}),y.jsx("option",{value:"Baskerville",style:{fontFamily:"Baskerville"},children:"Baskerville"}),y.jsx("option",{value:"Cambria",style:{fontFamily:"Cambria"},children:"Cambria"}),y.jsx("option",{value:"Minion Pro",style:{fontFamily:"Minion Pro"},children:"Minion Pro"}),y.jsx("option",{value:"Caslon",style:{fontFamily:"Caslon"},children:"Caslon"}),y.jsx("option",{value:"Crimson Text",style:{fontFamily:"Crimson Text"},children:"Crimson Text"}),y.jsx("option",{value:"Playfair Display",style:{fontFamily:"Playfair Display"},children:"Playfair Display"}),y.jsx("option",{value:"Merriweather",style:{fontFamily:"Merriweather"},children:"Merriweather"}),y.jsx("option",{value:"Lora",style:{fontFamily:"Lora"},children:"Lora"}),y.jsx("option",{value:"PT Serif",style:{fontFamily:"PT Serif"},children:"PT Serif"}),y.jsx("option",{value:"Courier New",style:{fontFamily:"Courier New"},children:"Courier New"}),y.jsx("option",{value:"Monaco",style:{fontFamily:"Monaco"},children:"Monaco"}),y.jsx("option",{value:"Consolas",style:{fontFamily:"Consolas"},children:"Consolas"}),y.jsx("option",{value:"Lucida Console",style:{fontFamily:"Lucida Console"},children:"Lucida Console"}),y.jsx("option",{value:"Source Code Pro",style:{fontFamily:"Source Code Pro"},children:"Source Code Pro"}),y.jsx("option",{value:"Fira Code",style:{fontFamily:"Fira Code"},children:"Fira Code"}),y.jsx("option",{value:"Impact",style:{fontFamily:"Impact"},children:"Impact"}),y.jsx("option",{value:"Bebas Neue",style:{fontFamily:"Bebas Neue"},children:"Bebas Neue"}),y.jsx("option",{value:"Oswald",style:{fontFamily:"Oswald"},children:"Oswald"}),y.jsx("option",{value:"Raleway",style:{fontFamily:"Raleway"},children:"Raleway"}),y.jsx("option",{value:"Quicksand",style:{fontFamily:"Quicksand"},children:"Quicksand"}),y.jsx("option",{value:"Comfortaa",style:{fontFamily:"Comfortaa"},children:"Comfortaa"}),y.jsx("option",{value:"Dancing Script",style:{fontFamily:"Dancing Script"},children:"Dancing Script"}),y.jsx("option",{value:"Pacifico",style:{fontFamily:"Pacifico"},children:"Pacifico"}),y.jsx("option",{value:"Lobster",style:{fontFamily:"Lobster"},children:"Lobster"}),y.jsx("option",{value:"Great Vibes",style:{fontFamily:"Great Vibes"},children:"Great Vibes"}),y.jsx("option",{value:"Amatic SC",style:{fontFamily:"Amatic SC"},children:"Amatic SC"}),y.jsx("option",{value:"Righteous",style:{fontFamily:"Righteous"},children:"Righteous"})]}),y.jsxs("div",{className:"mt-2 p-3 border rounded bg-background",children:[y.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Preview:"}),y.jsx("p",{style:{fontFamily:w.fontFamily,fontSize:`${Math.min(w.fontSize,24)}px`,fontWeight:w.fontWeight,color:w.color},className:"truncate",children:"name"===w.type?"John Doe":"CERT-2024-001"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Font Weight"}),y.jsxs("select",{value:w.fontWeight,onChange:e=>N(x,{fontWeight:e.target.value}),className:"input",children:[y.jsx("option",{value:"normal",children:"Normal"}),y.jsx("option",{value:"bold",children:"Bold"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Color"}),y.jsx("input",{type:"color",value:w.color,onChange:e=>N(x,{color:e.target.value}),className:"input h-10"})]})]})]})]})]})]})},_=({isOpen:e,onClose:t,onConfirm:s,title:r,message:a,confirmButtonText:n="Confirm",cancelButtonText:l="Cancel",requiresTextConfirmation:o=!1,requiredText:i="",userInput:d="",onInputChange:c})=>{if(!e)return null;const m=o&&d!==i;return y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r}),y.jsx("div",{className:"mb-6",children:y.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:a})}),o&&y.jsxs("div",{className:"mb-6",children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:['Type "',i,'" to confirm:']}),y.jsx("input",{type:"text",value:d,onChange:e=>null==c?void 0:c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:i})]}),y.jsxs("div",{className:"flex justify-end space-x-3",children:[y.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:l}),y.jsx("button",{onClick:s,disabled:m,className:"px-4 py-2 text-white rounded-md focus:outline-none focus:ring-2 "+(m?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 focus:ring-red-500"),children:n})]})]})})},q=({progress:e,onClose:t})=>{if(!e)return null;const s="bulk_download_error"===e.operation,r="bulk_download_complete"===e.operation,a="processing"===e.status||"finalizing"===e.status;return y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in",children:y.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 w-full max-w-lg mx-4 animate-scale-in glass-effect border border-gray-200 dark:border-gray-600",children:[y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[y.jsxs("div",{className:"flex items-center",children:[s?y.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-red-500 to-pink-600 rounded-full flex items-center justify-center mr-3 shadow-glow",children:y.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01"})})}):r?y.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center mr-3 shadow-glow-green animate-pulse",children:y.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):y.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-3 shadow-glow-purple",children:y.jsx("svg",{className:"w-4 h-4 text-white animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),y.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:s?"Download Error":r?"Download Complete":"Bulk Download Progress"})]}),(s||r)&&y.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:scale-110 transition-all duration-200 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s?y.jsxs("div",{className:"text-center animate-slide-up",children:[y.jsx("div",{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-full bg-gradient-to-br from-red-100 to-pink-100 dark:from-red-900 dark:to-pink-900 mb-6 shadow-glow animate-pulse",children:y.jsx("svg",{className:"h-10 w-10 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),y.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Download Failed"}),y.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:y.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 font-medium",children:e.error||"An error occurred during the bulk download process."})}),y.jsxs("button",{onClick:t,className:"btn btn-destructive btn-md hover-lift shadow-glow transition-all duration-200",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Close"]})]}):r?y.jsxs("div",{className:"text-center animate-slide-up",children:[y.jsx("div",{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900 dark:to-emerald-900 mb-6 shadow-glow-green animate-pulse",children:y.jsx("svg",{className:"h-10 w-10 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),y.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Download Complete!"}),y.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-6",children:[y.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 font-medium",children:e.message}),e.zipFileName&&y.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-2",children:["File: ",e.zipFileName]}),y.jsx("div",{className:"flex items-center justify-center mt-3",children:y.jsxs("div",{className:"flex items-center text-xs text-green-600 dark:text-green-400",children:[y.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),y.jsx("span",{className:"font-medium",children:e.added})," of ",y.jsx("span",{className:"font-medium",children:e.total})," certificates included"]})})]}),y.jsxs("button",{onClick:t,className:"btn btn-success btn-md hover-lift shadow-glow-green transition-all duration-200",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Done"]})]}):y.jsxs("div",{className:"animate-slide-up",children:[y.jsxs("div",{className:"mb-6",children:[y.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-2"}),y.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Processing certificates..."})]}),y.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 bg-clip-text text-transparent font-bold",children:[e.processed," / ",e.total]})]}),y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 shadow-inner",children:y.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500 ease-out shadow-glow-purple relative overflow-hidden",style:{width:`${e.percentage}%`},children:y.jsx("div",{className:"absolute inset-0 bg-white opacity-20 animate-pulse"})})}),y.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2",children:y.jsxs("div",{className:"bg-gray-900 dark:bg-white text-white dark:text-gray-900 text-xs px-2 py-1 rounded-md shadow-lg",children:[e.percentage,"%"]})})]}),y.jsxs("div",{className:"flex justify-between items-center mt-4 text-xs text-gray-500 dark:text-gray-400",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Estimated time remaining: ",Math.max(0,Math.ceil(.5*(e.total-e.processed))),"s"]}),y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-1 h-1 bg-green-500 rounded-full mr-1 animate-pulse"}),e.percentage,"% complete"]})]})]}),e.message&&y.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg p-3 mb-4",children:y.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.message]})}),e.currentFile&&y.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-4",children:[y.jsxs("div",{className:"flex items-center text-sm",children:[y.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),y.jsx("span",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Currently processing:"})]}),y.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1 font-mono bg-blue-100 dark:bg-blue-900/40 px-2 py-1 rounded",children:e.currentFile})]}),y.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center mb-4",children:[y.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-800",children:[y.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:e.processed}),y.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:"Processed"})]}),y.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg p-3 border border-green-200 dark:border-green-800",children:[y.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:e.added}),y.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:"Added"})]}),y.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg p-3 border border-purple-200 dark:border-purple-800",children:[y.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:e.total}),y.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium",children:"Total"})]})]}),a&&y.jsxs("div",{className:"flex items-center justify-center p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-200 dark:border-blue-700"}),y.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-blue-600 absolute top-0 left-0"})]}),y.jsx("span",{className:"ml-3 text-sm font-medium bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"finalizing"===e.status?"Finalizing download...":"Processing certificates..."})]})]})]})})},J=({variant:e="rectangle",width:t="w-full",height:s="h-4",className:r="",count:a=1})=>{const n=y.jsx("div",{className:`animate-pulse bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 bg-[length:200%_100%] animate-shimmer ${(()=>{switch(e){case"card":return"rounded-xl p-6 h-32";case"table-row":return"rounded-lg h-16";case"text":return"rounded h-4";case"circle":return"rounded-full";default:return"rounded-lg"}})()} ${t} ${s} ${r}`});return 1===a?n:y.jsx(y.Fragment,{children:Array.from({length:a},(e,t)=>y.jsx("div",{className:"mb-4 last:mb-0",children:n},t))})},Y=()=>y.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 animate-fade-in",children:[y.jsx("td",{className:"px-6 py-4",children:y.jsx(J,{variant:"circle",width:"w-5",height:"h-5"})}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(J,{variant:"circle",width:"w-8",height:"h-8"}),y.jsxs("div",{className:"space-y-1",children:[y.jsx(J,{variant:"text",width:"w-24",height:"h-4"}),y.jsx(J,{variant:"text",width:"w-16",height:"h-3"})]})]})}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"space-y-1",children:[y.jsx(J,{variant:"text",width:"w-20",height:"h-4"}),y.jsx(J,{variant:"text",width:"w-16",height:"h-3"})]})}),y.jsx("td",{className:"px-6 py-4",children:y.jsx(J,{variant:"text",width:"w-18",height:"h-4"})}),y.jsx("td",{className:"px-6 py-4",children:y.jsx(J,{variant:"rectangle",width:"w-16",height:"h-6",className:"rounded-full"})}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"flex items-center space-x-1",children:[y.jsx(J,{variant:"circle",width:"w-4",height:"h-4"}),y.jsx(J,{variant:"text",width:"w-8",height:"h-4"})]})}),y.jsx("td",{className:"px-6 py-4",children:y.jsx(J,{variant:"text",width:"w-20",height:"h-4"})}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"flex space-x-2",children:[y.jsx(J,{variant:"rectangle",width:"w-8",height:"h-8",className:"rounded-lg"}),y.jsx(J,{variant:"rectangle",width:"w-8",height:"h-8",className:"rounded-lg"}),y.jsx(J,{variant:"rectangle",width:"w-8",height:"h-8",className:"rounded-lg"})]})})]}),K=()=>{const{token:t}=B(),{showToast:s}=M(),{isConnected:r,bulkDownloadProgress:a}=(()=>{const{token:t}=B(),s=e.useRef(null),[r,a]=e.useState(!1),[n,l]=e.useState(null),[o,i]=e.useState(null),d=e.useRef(null),c=e.useRef(0),m=e.useCallback(()=>{if(t)try{const e=`${"https://certificatebackend-13k8.onrender.com/api".replace("http://","ws://").replace("/api","")}/ws?token=${encodeURIComponent(t)}`;console.log("Connecting to WebSocket:",e),s.current=new WebSocket(e),s.current.onopen=()=>{console.log("WebSocket connected"),a(!0),c.current=0},s.current.onmessage=e=>{try{const t=JSON.parse(e.data);if(console.log("WebSocket message received:",t),l(t),"progress"===t.type&&t.data){const{operation:e}=t.data;"bulk_download"!==e&&"bulk_download_complete"!==e&&"bulk_download_error"!==e||i(t.data)}}catch(t){console.error("Error parsing WebSocket message:",t)}},s.current.onclose=e=>{if(console.log("WebSocket disconnected:",e.code,e.reason),a(!1),1e3!==e.code&&c.current<5){const e=Math.min(1e3*Math.pow(2,c.current),3e4);console.log(`Attempting to reconnect in ${e}ms (attempt ${c.current+1}/5)`),d.current=setTimeout(()=>{c.current++,m()},e)}},s.current.onerror=e=>{console.error("WebSocket error:",e),a(!1)}}catch(e){console.error("Error creating WebSocket connection:",e)}else console.log("No token available for WebSocket connection")},[t]),h=e.useCallback(()=>{d.current&&(clearTimeout(d.current),d.current=null),s.current&&(s.current.close(1e3,"Component unmounting"),s.current=null),a(!1),l(null),i(null)},[]),x=e.useCallback(e=>{s.current&&s.current.readyState===WebSocket.OPEN?s.current.send(JSON.stringify(e)):console.warn("WebSocket is not connected. Cannot send message:",e)},[]);return e.useEffect(()=>(t?m():h(),()=>{h()}),[t,m,h]),{isConnected:r,lastMessage:n,sendMessage:x,bulkDownloadProgress:o}})(),[l,o]=e.useState([]),[d,c]=e.useState(!0),[m,h]=e.useState({currentPage:1,totalPages:1,totalCertificates:0,hasNext:!1,hasPrev:!1}),[x,u]=e.useState(new Set),[p,g]=e.useState(!1),[f,j]=e.useState(!1),[v,b]=e.useState("pdf"),[N,k]=e.useState(""),[w,C]=e.useState("all"),[L,S]=e.useState("all"),[T,P]=e.useState("createdAt"),[z,F]=e.useState("desc"),[A,E]=e.useState([]),[W,$]=e.useState(!1),[D,R]=e.useState(""),I="https://certificatebackend-13k8.onrender.com/api";e.useEffect(()=>{V(),U()},[m.currentPage,N,w,L,T,z]);const V=async()=>{try{if(c(!0),!t)return void c(!1);const e=new URLSearchParams({page:m.currentPage.toString(),limit:"10",sortBy:T,sortOrder:z});N&&e.append("search",N),"all"!==w&&e.append("status",w),"all"!==L&&e.append("template",L);const r=await fetch(`${I}/certificate?${e}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(r.ok){const e=await r.json();o(e.data.certificates||[]),h(e.data.pagination||{currentPage:1,totalPages:1,totalCertificates:0,hasNext:!1,hasPrev:!1})}else s("Failed to load certificates","error")}catch(e){console.error("Error fetching certificates:",e);const t=O("loading certificates",e);s(t,"error")}finally{c(!1)}},U=async()=>{try{const e=await fetch(`${I}/template?limit=100&status=active`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();E(t.data.templates||[])}}catch(e){console.error("Error fetching templates:",e)}},H=async(e,r)=>{try{const a=await fetch(`${I}/certificate/${e}/download/${r}`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const t=await a.blob(),n=window.URL.createObjectURL(t),l=document.createElement("a");l.href=n,l.download=`certificate_${e}.${r}`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(n),document.body.removeChild(l),s(`Certificate downloaded as ${r.toUpperCase()}`,"success"),V()}else s("Failed to download certificate","error")}catch(a){console.error("Error downloading certificate:",a);let e="Unknown network error";try{a&&"object"==typeof a?"message"in a&&a.message?e=String(a.message):"toString"in a&&"function"==typeof a.toString&&(e=a.toString()):a&&(e=String(a))}catch(n){console.error("Error while processing error message:",n),e="Network error occurred"}s(`Network error while downloading certificate: ${e}`,"error")}},G=e=>{h(t=>({...t,currentPage:e}))},J=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),K=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return i.useEffect(()=>{a&&(j(!0),"bulk_download_complete"===a.operation&&setTimeout(()=>{j(!1)},3e3))},[a]),y.jsxs("div",{className:"space-y-8 animate-fade-in",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"animate-slide-up",children:[y.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"Certificates"}),y.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2 text-lg",children:"Manage and download your generated certificates with ease"})]}),y.jsxs("div",{className:"flex items-center space-x-4 animate-slide-up",children:[l.length>0&&y.jsxs("button",{onClick:()=>{console.log("Clear all certificates button clicked"),$(!0),R("")},className:"btn btn-destructive btn-md hover-lift",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear All"]}),y.jsxs(n,{to:"/generate",className:"btn btn-gradient btn-md hover-lift shadow-glow-purple",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Generate Certificate"]})]})]}),y.jsx("div",{className:"card-glass animate-slide-up",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[y.jsxs("div",{className:"lg:col-span-2",children:[y.jsx("label",{className:"block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300",children:"Search Certificates"}),y.jsxs("div",{className:"flex gap-3",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),y.jsx("input",{type:"text",placeholder:"Search by participant name or certificate ID...",value:N,onChange:e=>k(e.target.value),className:"input pl-10 shadow-sm border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),x.size>0&&y.jsxs("div",{className:"flex items-center gap-3 animate-scale-in",children:[y.jsxs("select",{value:v,onChange:e=>b(e.target.value),className:"input shadow-sm border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:[y.jsx("option",{value:"pdf",children:"PDF Format"}),y.jsx("option",{value:"png",children:"PNG Format"})]}),y.jsx("button",{onClick:async()=>{if(0!==x.size)try{g(!0),j(!0);const e=await fetch(`${I}/certificate/bulk-download`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({certificateIds:Array.from(x),format:v})});if(e.ok){const t=await e.blob(),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r;const n=e.headers.get("Content-Disposition");let l=`certificates-${v}-${(new Date).toISOString().slice(0,10)}.zip`;if(n){const e=n.match(/filename="(.+)"/);e&&(l=e[1])}a.download=l,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a),s(`Successfully downloaded ${x.size} certificates as ${v.toUpperCase()}`,"success"),u(new Set),V()}else{const t=await e.json();s(t.message||"Failed to download certificates","error")}}catch(e){console.error("Error during bulk download:",e),s("Network error during bulk download","error")}finally{g(!1)}else s("Please select certificates to download","error")},disabled:p||!r,className:"btn btn-success btn-sm whitespace-nowrap hover-lift shadow-glow-green",children:p?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Processing..."]}):y.jsxs(y.Fragment,{children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download ",x.size," Certificate",x.size>1?"s":""]})})]})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),y.jsxs("select",{value:w,onChange:e=>C(e.target.value),className:"input",children:[y.jsx("option",{value:"all",children:"All Status"}),y.jsx("option",{value:"generated",children:"Generated"}),y.jsx("option",{value:"downloaded",children:"Downloaded"}),y.jsx("option",{value:"archived",children:"Archived"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Template"}),y.jsxs("select",{value:L,onChange:e=>S(e.target.value),className:"input",children:[y.jsx("option",{value:"all",children:"All Templates"}),A.map(e=>y.jsx("option",{value:e._id,children:e.name},e._id))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sort By"}),y.jsxs("div",{className:"flex space-x-2",children:[y.jsxs("select",{value:T,onChange:e=>P(e.target.value),className:"input flex-1",children:[y.jsx("option",{value:"createdAt",children:"Created Date"}),y.jsx("option",{value:"participantName",children:"Participant"}),y.jsx("option",{value:"certificateId",children:"Certificate ID"}),y.jsx("option",{value:"downloadCount",children:"Downloads"})]}),y.jsx("button",{onClick:()=>F("asc"===z?"desc":"asc"),className:"btn btn-outline btn-sm px-2",title:"Sort "+("asc"===z?"Descending":"Ascending"),children:y.jsx("svg",{className:"w-4 h-4 transform "+("desc"===z?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})})})]})]})]})})}),y.jsxs("div",{className:"card-elevated animate-slide-up",children:[y.jsx("div",{className:"card-header",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("h3",{className:"card-title flex items-center",children:[y.jsx("svg",{className:"w-6 h-6 mr-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Certificates"]}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsxs("span",{className:"px-3 py-1 bg-gradient-to-r from-blue-100 to-purple-100 text-blue-800 dark:from-blue-900 dark:to-purple-900 dark:text-blue-200 rounded-full text-sm font-semibold",children:[m.totalCertificates," Total"]}),x.size>0&&y.jsxs("span",{className:"px-3 py-1 bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 dark:from-green-900 dark:to-emerald-900 dark:text-green-200 rounded-full text-sm font-semibold animate-pulse-slow",children:[x.size," Selected"]})]})]})}),y.jsx("div",{className:"card-content",children:d?y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full",children:[y.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Certificate"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Participant"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Template"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Downloads"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 4v10a2 2 0 002 2h4a2 2 0 002-2V11m-6 0h6"})}),"Created"]})}),y.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})}),"Actions"]})})]})}),y.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Array.from({length:5},(e,t)=>y.jsx(Y,{},t))})]})}):0===l.length?y.jsxs("div",{className:"text-center py-16",children:[y.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center",children:y.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),y.jsx("h3",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"No certificates found"}),y.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Get started by generating your first certificate"}),y.jsxs(n,{to:"/generate",className:"btn btn-gradient btn-md hover-lift shadow-glow-purple",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Generate Your First Certificate"]})]}):y.jsx("div",{className:"overflow-x-auto rounded-lg",children:y.jsxs("table",{className:"w-full",children:[y.jsx("thead",{children:y.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b border-gray-200 dark:border-gray-600",children:[y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",checked:x.size===l.length&&l.length>0,onChange:()=>{x.size===l.length?u(new Set):u(new Set(l.map(e=>e._id)))},className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2 transition-all duration-200"}),y.jsx("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:"All"})]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Certificate"]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Participant"]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),"Template"]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status"]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"Downloads"]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Created"]})}),y.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300",children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})}),"Actions"]})})]})}),y.jsx("tbody",{children:l.map((e,r)=>{var a,n,l,o,i,d;return y.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 dark:hover:from-blue-900/20 dark:hover:to-purple-900/20 transition-all duration-300 hover:shadow-md animate-fade-in hover-lift",style:{animationDelay:50*r+"ms"},children:[y.jsx("td",{className:"py-4 px-6",children:y.jsx("div",{className:"flex items-center",children:y.jsx("input",{type:"checkbox",checked:x.has(e._id),onChange:()=>(e=>{const t=new Set(x);t.has(e)?t.delete(e):t.add(e),u(t)})(e._id),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2 transition-all duration-200 hover:scale-110"})})}),y.jsx("td",{className:"py-4 px-6",children:y.jsxs("div",{className:"flex flex-col space-y-2",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3 animate-pulse-slow"}),y.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:e.certificateId})]}),y.jsx("div",{className:"ml-5",children:y.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(null==(a=e.generatedFiles)?void 0:a.pdf)?y.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded-full text-xs font-medium mr-2",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),"PDF: ",K(e.generatedFiles.pdf.size)]}):null,(null==(n=e.generatedFiles)?void 0:n.png)?y.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-full text-xs font-medium",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),"PNG: ",K(e.generatedFiles.png.size)]}):null,!(null==(l=e.generatedFiles)?void 0:l.pdf)&&!(null==(o=e.generatedFiles)?void 0:o.png)&&y.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded-full text-xs font-medium",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Generation failed"]})]})})]})}),y.jsx("td",{className:"py-4 px-6",children:y.jsxs("div",{className:"flex items-center space-y-2",children:[y.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mr-3 shadow-md",children:y.jsx("span",{className:"text-white font-semibold text-sm",children:e.participantName.charAt(0).toUpperCase()})}),y.jsxs("div",{children:[y.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.participantName}),e.tags.length>0&&y.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,t)=>y.jsx("span",{className:"px-2 py-1 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-700 text-blue-800 dark:text-blue-200 text-xs rounded-full font-medium hover:scale-105 transition-transform duration-200",children:e},t)),e.tags.length>2&&y.jsxs("span",{className:"px-2 py-1 bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700 text-gray-800 dark:text-gray-200 text-xs rounded-full font-medium",children:["+",e.tags.length-2]})]})]})]})}),y.jsx("td",{className:"py-4 px-6",children:y.jsxs("div",{className:"flex flex-col space-y-1",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded mr-2 shadow-sm"}),y.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.template.name})]}),y.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 ml-5",children:e.templateSnapshot.filename})]})}),y.jsx("td",{className:"py-4 px-6",children:y.jsx("div",{className:"flex items-center",children:y.jsxs("div",{className:"flex items-center px-3 py-1 rounded-full text-xs font-semibold shadow-sm "+("generated"===e.status?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 dark:from-green-900 dark:to-emerald-900 dark:text-green-200":"downloaded"===e.status?"bg-gradient-to-r from-blue-100 to-cyan-100 text-blue-800 dark:from-blue-900 dark:to-cyan-900 dark:text-blue-200":"archived"===e.status?"bg-gradient-to-r from-gray-100 to-slate-100 text-gray-800 dark:from-gray-900 dark:to-slate-900 dark:text-gray-200":"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800 dark:from-yellow-900 dark:to-orange-900 dark:text-yellow-200"),children:[y.jsx("div",{className:"w-2 h-2 rounded-full mr-2 "+("generated"===e.status?"bg-green-500 animate-pulse":"downloaded"===e.status?"bg-blue-500":"archived"===e.status?"bg-gray-500":"bg-yellow-500 animate-pulse")}),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})})}),y.jsxs("td",{className:"py-4 px-6",children:[y.jsx("div",{className:"flex items-center",children:y.jsxs("div",{className:"flex items-center px-3 py-1 bg-gradient-to-r from-indigo-100 to-blue-100 dark:from-indigo-900 dark:to-blue-900 text-indigo-800 dark:text-indigo-200 rounded-full shadow-sm",children:[y.jsx("svg",{className:"w-3 h-3 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),y.jsx("span",{className:"font-semibold text-sm",children:e.metadata.downloadCount})]})}),y.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 ml-1",children:"downloads"})]}),y.jsx("td",{className:"py-4 px-6",children:y.jsxs("div",{className:"flex flex-col space-y-1",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),y.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:J(e.createdAt)})]}),y.jsxs("div",{className:"flex items-center ml-6",children:[y.jsx("svg",{className:"w-3 h-3 mr-2 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),y.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Issued: ",J(e.issuedDate)]})]})]})}),y.jsx("td",{className:"py-4 px-6",children:y.jsxs("div",{className:"flex items-center justify-end space-x-2",children:["archived"!==e.status&&"generated"===e.status&&y.jsxs(y.Fragment,{children:[(null==(i=e.generatedFiles)?void 0:i.pdf)&&y.jsxs("button",{onClick:()=>H(e._id,"pdf"),className:"btn btn-outline btn-sm hover-lift shadow-glow transition-all duration-200 hover:shadow-glow-red",title:"Download PDF",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),"PDF"]}),(null==(d=e.generatedFiles)?void 0:d.png)&&y.jsxs("button",{onClick:()=>H(e._id,"png"),className:"btn btn-outline btn-sm hover-lift shadow-glow transition-all duration-200 hover:shadow-glow-green",title:"Download PNG",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),"PNG"]})]}),"archived"!==e.status&&y.jsxs("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to archive this certificate?"))try{const r=await fetch(`${I}/certificate/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(r.ok)s("Certificate archived successfully","success"),V();else{const e=await r.json();s(e.message||"Failed to archive certificate","error")}}catch(r){console.error("Error archiving certificate:",r);let e="Unknown network error";try{r&&"object"==typeof r?"message"in r&&r.message?e=String(r.message):"toString"in r&&"function"==typeof r.toString&&(e=r.toString()):r&&(e=String(r))}catch(a){console.error("Error while processing error message:",a),e="Network error occurred"}s(`Network error while archiving certificate: ${e}`,"error")}})(e._id),className:"btn btn-outline btn-sm text-red-600 hover:text-red-700 hover-lift transition-all duration-200 hover:scale-105",title:"Archive Certificate",children:[y.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Archive"]})]})})]},e._id)})})]})})})]}),m.totalPages>1&&y.jsxs("div",{className:"flex items-center justify-between mt-8 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:[y.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[y.jsx("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),y.jsxs("span",{className:"font-medium",children:["Showing ",y.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:10*(m.currentPage-1)+1})," to ",y.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:Math.min(10*m.currentPage,m.totalCertificates)})," of ",y.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:m.totalCertificates})," certificates"]})]}),y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsxs("button",{onClick:()=>G(m.currentPage-1),disabled:!m.hasPrev,className:"btn btn-outline btn-sm hover-lift transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[y.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),y.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,m.totalPages)},(e,t)=>{const s=Math.max(1,Math.min(m.totalPages-4,m.currentPage-2))+t;return y.jsx("button",{onClick:()=>G(s),className:"px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover-lift "+(s===m.currentPage?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-glow-purple":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-white dark:hover:bg-gray-600 shadow-sm"),children:s},s)})}),y.jsxs("button",{onClick:()=>G(m.currentPage+1),disabled:!m.hasNext,className:"btn btn-outline btn-sm hover-lift transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",y.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),y.jsx(_,{isOpen:W,onClose:()=>{$(!1),R("")},onConfirm:async()=>{if(console.log("User confirmed deletion with text:",D),"DELETE ALL CERTIFICATES"!==D)return console.log("Confirmation text did not match, cancelling deletion"),s("Deletion cancelled. Confirmation text did not match.","error"),void $(!1);if(console.log("Confirmation text matched, proceeding with deletion"),console.log("API URL:",`${I}/certificate/bulk`),console.log("Token:",t?"Present":"Missing"),!t)return s("Authentication required. Please log in again.","error"),void $(!1);c(!0),o([]),h({currentPage:1,totalPages:0,totalCertificates:0,hasNext:!1,hasPrev:!1});try{const e=await fetch(`${I}/certificate/bulk`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({confirmText:"DELETE ALL CERTIFICATES"})});console.log("Response status:",e.status),console.log("Response ok:",e.ok);const r=await e.json();if(console.log("Response data:",r),e.ok){const e=r.data.deletedCount||0,t=r.data.filesDeleted||0;s(`Successfully deleted ${e} certificates and ${t} files`,"success"),await V(),console.log("Bulk deletion completed successfully")}else console.error("Delete failed with response:",r),s(r.message||"Failed to delete certificates","error"),await V()}catch(e){console.error("Error deleting all certificates:",e);let t="Unknown network error";try{e&&"object"==typeof e?"message"in e&&e.message?t=String(e.message):"toString"in e&&"function"==typeof e.toString&&(t=e.toString()):e&&(t=String(e))}catch(r){console.error("Error while processing error message:",r),t="Network error occurred"}s(`Network error while deleting certificates: ${t}`,"error"),await V()}finally{c(!1),$(!1),R("")}},title:"Delete All Certificates",message:"This action will permanently delete ALL certificates. This cannot be undone.\\n\\nTo confirm, please type: DELETE ALL CERTIFICATES",confirmButtonText:"Delete All",cancelButtonText:"Cancel",requiresTextConfirmation:!0,requiredText:"DELETE ALL CERTIFICATES",userInput:D,onInputChange:R}),f&&y.jsx(q,{onClose:()=>{j(!1)},progress:a})]})},Q=()=>{const t=a(),{token:s}=B(),{showToast:r}=M(),[n,l]=e.useState([]),[o,i]=e.useState(null),[d,c]=e.useState(!0),[m,h]=e.useState(!1),[x,u]=e.useState(""),[p,g]=e.useState([]),[f,j]=e.useState([]),[v,b]=e.useState(""),[N,k]=e.useState(""),[w,C]=e.useState((new Date).toISOString().split("T")[0]),[L,S]=e.useState(""),T="https://certificatebackend-13k8.onrender.com/api";e.useEffect(()=>{P()},[]),e.useEffect(()=>{o&&g(o.placeholders.map((e,t)=>({placeholderIndex:t,value:""})))},[o]);const P=async()=>{try{c(!0);const e=await fetch(`${T}/template?status=active&limit=100`,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();l(t.data.templates||[])}else r("Failed to load templates","error"),l([])}catch(e){console.error("Error fetching templates:",e);const t=O("loading templates",e);r(t,"error"),l([])}finally{c(!1)}},z=()=>{v.trim()&&!f.includes(v.trim())&&(j(e=>[...e,v.trim()]),b(""))},F=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"flex items-center justify-between",children:y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Generate Certificate"}),y.jsx("p",{className:"text-muted-foreground mt-1",children:"Create a new certificate from a template"})]})}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[y.jsx("div",{className:"lg:col-span-1",children:y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Select Template"}),y.jsx("p",{className:"card-description",children:"Choose a template to generate certificate"})]}),y.jsx("div",{className:"card-content",children:d?y.jsx("div",{className:"flex items-center justify-center py-8",children:y.jsx(W,{size:"md",text:"Loading templates..."})}):0===n.length?y.jsxs("div",{className:"text-center py-8",children:[y.jsx("p",{className:"text-muted-foreground mb-4",children:"No active templates found"}),y.jsx("button",{onClick:()=>t("/templates"),className:"btn btn-primary btn-sm",children:"Upload Template"})]}):y.jsx("div",{className:"space-y-3",children:n.map(e=>y.jsx("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors "+((null==o?void 0:o._id)===e._id?"border-primary bg-primary/5":"border-border hover:bg-accent"),onClick:()=>i(e),children:y.jsxs("div",{className:"flex items-start space-x-3",children:[y.jsx("div",{className:"w-12 h-12 bg-secondary rounded flex items-center justify-center flex-shrink-0",children:y.jsx("svg",{className:"w-6 h-6 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("h4",{className:"font-medium text-foreground truncate",children:e.name}),y.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:e.description||"No description"}),y.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-muted-foreground",children:[y.jsxs("span",{children:[e.placeholders.length," placeholders"]}),y.jsx("span",{children:F(e.fileSize)})]})]})]})},e._id))})})]})}),y.jsx("div",{className:"lg:col-span-2",children:o?y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Template Preview"}),y.jsxs("p",{className:"card-description",children:[o.name," - ",o.placeholders.length," placeholders"]})]}),y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"relative border border-border rounded-lg overflow-hidden bg-white","data-template-container":!0,style:{maxWidth:"800px",aspectRatio:o.dimensions?`${o.dimensions.width} / ${o.dimensions.height}`:"16 / 9"},children:[y.jsx("img",{src:`${T}/template/${o._id}/file`,alt:o.name,className:"w-full h-auto max-h-96 object-contain"}),o.placeholders.map((e,t)=>{const s=p.find(e=>e.placeholderIndex===t);return y.jsx("div",{className:"absolute border-2 border-primary bg-primary/10 px-2 py-1 rounded pointer-events-none",style:{left:e.x,top:e.y,fontSize:Math.max(8,.5*e.fontSize),fontFamily:e.fontFamily,color:e.color,fontWeight:e.fontWeight},children:(null==s?void 0:s.value)||("name"===e.type?"Name":"ID")},t)})]})})]}),y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Certificate Details"}),y.jsx("p",{className:"card-description",children:"Fill in the details for the certificate"})]}),y.jsxs("div",{className:"card-content space-y-6",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Participant Name *"}),y.jsx("input",{type:"text",value:x,onChange:e=>u(e.target.value),placeholder:"Enter participant's full name",className:"input",required:!0})]}),o.placeholders.length>0&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Placeholder Values *"}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.placeholders.map((e,t)=>{const s=p.find(e=>e.placeholderIndex===t),r="name"===e.type?"Name":"ID";return y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:r}),y.jsx("input",{type:"text",value:(null==s?void 0:s.value)||"",onChange:e=>{return s=t,r=e.target.value,void g(e=>e.map(e=>e.placeholderIndex===s?{...e,value:r}:e));var s,r},placeholder:`Enter value for ${r}`,className:"input",required:!0})]},t)})})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Issued Date *"}),y.jsx("input",{type:"date",value:w,onChange:e=>C(e.target.value),className:"input",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Expiry Date (Optional)"}),y.jsx("input",{type:"date",value:L,onChange:e=>S(e.target.value),className:"input",min:w})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tags (Optional)"}),y.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:f.map(e=>y.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-sm bg-secondary text-secondary-foreground rounded",children:[e,y.jsx("button",{onClick:()=>{return t=e,void j(e=>e.filter(e=>e!==t));var t},className:"ml-1 text-muted-foreground hover:text-foreground",children:y.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e))}),y.jsxs("div",{className:"flex space-x-2",children:[y.jsx("input",{type:"text",value:v,onChange:e=>b(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),z())},placeholder:"Add a tag and press Enter",className:"input flex-1"}),y.jsx("button",{onClick:z,disabled:!v.trim(),className:"btn btn-outline btn-md",children:"Add"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes (Optional)"}),y.jsx("textarea",{value:N,onChange:e=>k(e.target.value),placeholder:"Add any additional notes about this certificate",rows:3,className:"input resize-none"})]}),y.jsxs("div",{className:"flex justify-end space-x-3",children:[y.jsx("button",{onClick:()=>{i(null),u(""),g([]),j([]),k(""),C((new Date).toISOString().split("T")[0]),S("")},className:"btn btn-outline btn-md",children:"Reset"}),y.jsx("button",{onClick:async()=>{if(o?x.trim()?!(p.filter(e=>!e.value.trim()).length>0&&(r("Please fill in all placeholder values","error"),1)):(r("Please enter participant name","error"),0):(r("Please select a template","error"),0))try{h(!0);const e=document.querySelector("[data-template-container]");let a={width:800,height:600};if(e){const t=e.getBoundingClientRect();a={width:t.width,height:t.height}}const n={templateId:o._id,participantName:x.trim(),placeholderValues:p.reduce((e,t)=>(e[o.placeholders[t.placeholderIndex].type]=t.value.trim(),e),{}),containerDimensions:a,tags:f,notes:N.trim(),issuedDate:w,expiryDate:L||void 0},l=await fetch(`${T}/certificate/create`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(n)});if(l.ok)await l.json(),r("Certificate generated successfully!","success"),u(""),g([]),j([]),k(""),C((new Date).toISOString().split("T")[0]),S(""),i(null),t("/certificates");else{const e=await l.json();r(e.message||"Failed to generate certificate","error")}}catch(e){console.error("Error generating certificate:",e);const t=O("generating certificate",e);r(t,"error")}finally{h(!1)}},disabled:m,className:"btn btn-primary btn-md",children:m?y.jsxs("div",{className:"flex items-center",children:[y.jsx(W,{size:"sm",className:"mr-2"}),"Generating..."]}):y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Generate Certificate"]})})]})]})]})]}):y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content",children:y.jsxs("div",{className:"text-center py-12",children:[y.jsx("svg",{className:"w-12 h-12 mx-auto text-muted-foreground mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),y.jsx("p",{className:"text-muted-foreground",children:"Select a template to start generating certificate"})]})})})})]})]})},X=()=>{const{admin:t,token:s,updateProfile:r}=B(),{theme:a,toggleTheme:n}=E(),{showToast:l}=M(),[o,i]=e.useState("profile"),[d,c]=e.useState(!1),[m,h]=e.useState({name:"",email:"",role:"",lastLogin:"",createdAt:""}),[x,u]=e.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[p,g]=e.useState({current:!1,new:!1,confirm:!1}),f="https://certificatebackend-13k8.onrender.com/api";e.useEffect(()=>{t&&h({name:t.name||"",email:t.email||"",role:t.role||"",lastLogin:t.lastLogin?t.lastLogin.toString():"",createdAt:""})},[t]);const j=e=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never",v=e=>{g(t=>({...t,[e]:!t[e]}))},b=e=>{switch(e){case"user":return y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});case"shield":return y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})});case"settings":return y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});default:return null}};return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Settings"}),y.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your account settings and preferences"})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[y.jsx("div",{className:"lg:col-span-1",children:y.jsx("div",{className:"card",children:y.jsx("div",{className:"card-content p-0",children:y.jsx("nav",{className:"space-y-1",children:[{id:"profile",name:"Profile",icon:"user"},{id:"security",name:"Security",icon:"shield"},{id:"preferences",name:"Preferences",icon:"settings"}].map(e=>y.jsxs("button",{onClick:()=>i(e.id),className:"w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors "+(o===e.id?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[b(e.icon),y.jsx("span",{className:"ml-3",children:e.name})]},e.id))})})})}),y.jsxs("div",{className:"lg:col-span-3",children:["profile"===o&&y.jsx("div",{className:"space-y-6",children:y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Profile Information"}),y.jsx("p",{className:"card-description",children:"Update your account profile information"})]}),y.jsxs("div",{className:"card-content space-y-4",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),y.jsx("input",{type:"text",value:m.name,onChange:e=>h(t=>({...t,name:e.target.value})),placeholder:"Enter your full name",className:"input",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address"}),y.jsx("input",{type:"email",value:m.email,className:"input bg-muted",disabled:!0,title:"Email cannot be changed"}),y.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Email address cannot be changed"})]})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Role"}),y.jsx("input",{type:"text",value:m.role,className:"input bg-muted capitalize",disabled:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Member Since"}),y.jsx("input",{type:"text",value:j(m.createdAt),className:"input bg-muted",disabled:!0})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Login"}),y.jsx("input",{type:"text",value:j(m.lastLogin),className:"input bg-muted",disabled:!0})]}),y.jsx("div",{className:"flex justify-end",children:y.jsx("button",{onClick:async()=>{if(m.name.trim())try{c(!0);const e=await fetch(`${f}/auth/profile`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({name:m.name.trim()})});if(e.ok){const t=await e.json();await r(t.admin),l("Profile updated successfully!","success")}else{const t=await e.json();l(t.message||"Failed to update profile","error")}}catch(e){console.error("Error updating profile:",e),l("Network error while updating profile","error")}finally{c(!1)}else l("Name is required","error")},disabled:d,className:"btn btn-primary btn-md",children:d?y.jsxs("div",{className:"flex items-center",children:[y.jsx(W,{size:"sm",className:"mr-2"}),"Saving..."]}):"Save Changes"})})]})]})}),"security"===o&&y.jsx("div",{className:"space-y-6",children:y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Change Password"}),y.jsx("p",{className:"card-description",children:"Update your password to keep your account secure"})]}),y.jsxs("div",{className:"card-content space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Current Password *"}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:p.current?"text":"password",value:x.currentPassword,onChange:e=>u(t=>({...t,currentPassword:e.target.value})),placeholder:"Enter your current password",className:"input pr-10",required:!0}),y.jsx("button",{type:"button",onClick:()=>v("current"),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-muted-foreground hover:text-foreground",children:p.current?y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"New Password *"}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:p.new?"text":"password",value:x.newPassword,onChange:e=>u(t=>({...t,newPassword:e.target.value})),placeholder:"Enter your new password",className:"input pr-10",required:!0,minLength:6}),y.jsx("button",{type:"button",onClick:()=>v("new"),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-muted-foreground hover:text-foreground",children:p.new?y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),y.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Password must be at least 6 characters long"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password *"}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:p.confirm?"text":"password",value:x.confirmPassword,onChange:e=>u(t=>({...t,confirmPassword:e.target.value})),placeholder:"Confirm your new password",className:"input pr-10",required:!0}),y.jsx("button",{type:"button",onClick:()=>v("confirm"),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-muted-foreground hover:text-foreground",children:p.confirm?y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),y.jsx("div",{className:"flex justify-end",children:y.jsx("button",{onClick:async()=>{if(x.currentPassword)if(x.newPassword)if(x.newPassword.length<6)l("New password must be at least 6 characters long","error");else if(x.newPassword===x.confirmPassword)try{c(!0);const e=await fetch(`${f}/auth/change-password`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({currentPassword:x.currentPassword,newPassword:x.newPassword})});if(e.ok)l("Password changed successfully!","success"),u({currentPassword:"",newPassword:"",confirmPassword:""});else{const t=await e.json();l(t.message||"Failed to change password","error")}}catch(e){console.error("Error changing password:",e),l("Network error while changing password","error")}finally{c(!1)}else l("New passwords do not match","error");else l("New password is required","error");else l("Current password is required","error")},disabled:d,className:"btn btn-primary btn-md",children:d?y.jsxs("div",{className:"flex items-center",children:[y.jsx(W,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})})]})]})}),"preferences"===o&&y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Appearance"}),y.jsx("p",{className:"card-description",children:"Customize the appearance of the application"})]}),y.jsx("div",{className:"card-content space-y-4",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-medium text-foreground",children:"Theme"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose between light and dark mode"})]}),y.jsx("button",{onClick:n,className:"btn btn-outline btn-md",children:"dark"===a?y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),"Switch to Light"]}):y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),"Switch to Dark"]})})]})})]}),y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("h3",{className:"card-title",children:"Application Information"}),y.jsx("p",{className:"card-description",children:"Information about the certificate management system"})]}),y.jsx("div",{className:"card-content space-y-4",children:y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Application Name"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Certificate Management System"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Version"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"1.0.0"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"Environment"}),y.jsx("p",{className:"text-sm text-muted-foreground",children:"Production"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium mb-1",children:"API Base URL"}),y.jsx("p",{className:"text-sm text-muted-foreground break-all",children:f})]})]})})]})]})]})]})]})},Z=()=>y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:y.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-9xl font-bold text-gray-300 dark:text-gray-600",children:"404"}),y.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Page not found"}),y.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Sorry, we couldn't find the page you're looking for."})]}),y.jsx("div",{children:y.jsx(n,{to:"/",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Go back home"})})]})});function ee(){return y.jsx(A,{children:y.jsx(C,{children:y.jsx(z,{children:y.jsx(d,{children:y.jsx("div",{className:"min-h-screen bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-100",children:y.jsxs(c,{children:[y.jsx(m,{path:"/login",element:y.jsx(R,{})}),y.jsxs(m,{path:"/",element:y.jsx($,{children:y.jsx(D,{})}),children:[y.jsx(m,{index:!0,element:y.jsx(r,{to:"/dashboard",replace:!0})}),y.jsx(m,{path:"dashboard",element:y.jsx(I,{})}),y.jsx(m,{path:"templates",element:y.jsx(U,{})}),y.jsx(m,{path:"templates/:id/edit",element:y.jsx(G,{})}),y.jsx(m,{path:"certificates",element:y.jsx(K,{})}),y.jsx(m,{path:"/generate",element:y.jsx(Q,{})}),y.jsx(m,{path:"settings",element:y.jsx(X,{})})]}),y.jsx(m,{path:"*",element:y.jsx(Z,{})})]})})})})})})}N.createRoot(document.getElementById("root")).render(y.jsx(i.StrictMode,{children:y.jsx(ee,{})}));
